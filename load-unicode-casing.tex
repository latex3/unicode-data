% File load-unicode-casing.tex
%
% Copyright 2015 The LaTeX3 Project
%
% You may freely use, modify and/or distribute this file.
%
% Issues with this file should be reported at
% https://github.com/latex3/unicode-data
%
% This file parses UnicodeData.txt, provided by the Unicode Consortium,
% and when used with a Unicode-capable engine sets the following TeX
% properties:
% - \catcode 11 for all letters (Unicode class "L")
% - \catcode 11 for all combining marks (Unicode class "M")
% - \sfcode 999 for all code points of class Lu (upper case letters)
% - \lccode for all of class Ll (upper case letters) to the code point
%   itself, and \luccode to the upper case mapping (or if not given
%   to the code point itself)
% - \uccode for all of class Lu (upper case letters) to the code point
%   itself, and \lccode to the lower case mapping (or if not given
%   to the code point itself)
% - \lccode and \uccode for all of class Lt (title case letters) to the
%    lower can upper case mappings (or if not given to the code point itself)
% - \lccode and \uccode for all other letter code points are set to
%   the code point itself
% - \lccode and/or \uccode for non-letter code points for which an upper
%   or lower case mapping is given
%
\ifx\Umathcode\undefined
  \expandafter\endinput
\fi
%
\begingroup
  \catcode`\{=1 %
  \catcode`\}=2 %
  \catcode`\#=6 %
  \def\firsttoken#1#2\relax{#1}%
  \def\parseunicodedataI#1;#2;#3;#4;#5;#6;#7;#8;#9;{%
    \parseunicodedataII#1;#3;#2 First>\relax
  }%
  \def\parseunicodedataII#1;#2;#3 First>#4\relax{%
    \ifx\relax#4\relax
      \expandafter\parseunicodedataIII
    \else
      \expandafter\parseunicodedataVI
    \fi
    #1;#2;%
  }%
  \def\parseunicodedataIII#1;#2;#3;#4;#5;#6;#7;#8\relax{%
    \parseunicodedataIV{#1}{#2}{#6}{#7}%
  }%
  \def\Ll{Ll}%
  \def\Lt{Lt}%
  \def\Lu{Lu}%
  \def\parseunicodedataIV#1#2#3#4{%
    \ifnum 0%
      \if L\firsttoken#2?\relax 1\fi
      \if M\firsttoken#2?\relax 1\fi
      >0 %
      \global\catcode"#1=11 %
      \global\lccode"#1="#1 %
      \global\uccode"#1="#1 %
      \def\temp{#2}%
      \ifx\Ll\temp
        \parseunicodedataV\uccode{#1}{#3}%
      \fi
      \ifx\Lt\temp
        \parseunicodedataV\uccode{#1}{#3}%
        \parseunicodedataV\lccode{#1}{#4}%
      \fi
      \ifx\Lu\temp
        \parseunicodedataV\lccode{#1}{#4}%
        \global\sfcode"#1=999 %
      \fi
    \else
      \ifx\relax#3\relax
      \else
        \global\uccode"#1="#3 %
      \fi
      \ifx\relax#4\relax
      \else
        \global\lccode"#1="#4 %
      \fi
    \fi
  }%
  \def\parseunicodedataV#1#2#3{%
    \ifx\relax#3\relax
    \else
      \global#1"#2="#3 %
    \fi
  }%
  \def\parseunicodedataVI#1;#2;#3\relax{%
    \read0 to \unicodedataline
    \expandafter\parseunicodedataVII\unicodedataline\relax#1;#2\relax
  }%
  \def\parseunicodedataVII#1;#2\relax#3;#4\relax{%
    \if L\firsttoken#4?\relax
      \count0="#3 %
      \loop
        \unless\ifnum\count0>"#1 %
          \global\catcode\count0=11 %
          \advance\count0 by 1 %
      \repeat
    \fi
  }%
  \def\storedpar{\par}%
  \openin0=UnicodeData.txt %
  \loop\unless\ifeof0 %
    \read0 to \unicodedataline  
    \ifx\unicodedataline\storedpar
    \else
      \expandafter\parseunicodedataI\unicodedataline\relax
    \fi
  \repeat
\endgroup